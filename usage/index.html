<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Usage</title>
    <meta name="description" content="Documentation for Rosella">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/rosella/assets/normalize.css?v=1721178457"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/rosella/assets/doctave-style.css?v=1721178457"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/rosella/assets/katex.css?v=1721178457" media="screen" />
    <link rel="stylesheet" type="text/css" href="/rosella/assets/prism-ghcolors.css?v=1721178457"
        media="screen" />

    <script>
        var DOCTAVE_TIMESTAMP = "1721178457";
        var BASE_PATH = "/rosella/";
        var color = localStorage.getItem('doctave-color')

        if (color === 'dark') {
            document.getElementsByTagName('html')[0].classList.remove('light');
            document.getElementsByTagName('html')[0].classList.add('dark');
        } else {
            document.getElementsByTagName('html')[0].classList.remove('dark');
            document.getElementsByTagName('html')[0].classList.add('light');
        }
    </script>

    
</head>

<body>
    <label for='menu-toggle-switch' class='menu-toggle-button'>
        â˜°
    </label>
    <input type="checkbox" id="menu-toggle-switch" value='0' />
    <div class='page'>
        <div class='header'>
            <div class='logo'>
                
                <h2 class='project-name'>
                    <a href="/rosella/">
                        Rosella
                    </a>
                </h2>
            </div>
            <div class='search'>
                <form id='search-form'>
    <input type='text' id='search-box' autocomplete="off" placeholder="Search..."></input>
    <span class='search-icon'>S</span>
    <ul id='search-results'></ul>
</form>

            </div>
            <div class='header-dummy-right'>
            </div>
        </div>
        <div class='container'>
            <div class='sidebar-left'>
                <nav class='site-nav'>
    <ul>
        
            <li><a href="/rosella/installation">Installation</a></li>
            
        
            <li><a class="active" href="/rosella/usage">Usage</a></li>
            
                <ul>
    
        <li><a href="/rosella/usage/rosella-recover">rosella-recover</a></li>
        
    
        <li><a href="/rosella/usage/rosella-refine">rosella-refine</a></li>
        
    
</ul>

            
        
            <li><a href="/rosella/concepts">Concepts</a></li>
            
        
            <li><a href="/rosella/performance">Performance</a></li>
            
        
            <li><a href="/rosella/faqs">FAQs</a></li>
            
        
    </ul>
    <span id='light-dark-mode-switch'>
        <svg xmlns="http://www.w3.org/2000/svg" id="dark-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
        </svg>

        <svg xmlns="http://www.w3.org/2000/svg" id="light-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
        </svg>
    </span>
</nav>

            </div>
            <div class='doctave-content'>
                <h1 id="getting-started">Getting started</h1>
<h2 id="inputs">Inputs</h2>
<p>Rosella can be run multiple different ways in order to make using it as easy as possible.</p>
<h3 id="option-1:-precomputed-coverage-values">Option 1: Precomputed coverage values</h3>
<p>The most likely situation is that you are running rosella in conjunction with other
binning algorithms, like metabat2. If so, then you likely already have coverage values precomputed
using <code>coverm contig</code> using <code>-m metabat</code>.</p>
<p>To perform mag recovery:</p>
<pre><code>rosella recover -r scaffolds.fasta --coverage-values coverm.cov -o rosella_bin/ -t 24
</code></pre>
<h3 id="option-2:-use-rosella-to-get-coverage-values">Option 2: Use rosella to get coverage values</h3>
<p>If you have yet to run <code>CoverM</code> then rosella can generate the coverage values for you!
This is especially useful if you have both long and short reads as they can be passed
to rosella in tandem. Don't be afraid to pass multiple samples at once to rosella either,
it can handle it and keep everything in order.</p>
<pre><code>rosella recover -r scaffolds.fasta -1 short_s[12345].1.fastq.gz -2 short_s[12345].2.fastq.gz --longreads nanopore.fastq.gz -o rosella_bins/
</code></pre>
<p>You can keep the BAM files that are created by rosella by including the <code>--bam-file-cache-directory</code>
flag. Once the coverage values are calculated, they will be stored in the output direcotry along with
the kmer frequency file.</p>
<h3 id="option-3:-refining-the-results-of-other-binners">Option 3: Refining the results of other binners</h3>
<p>Rosella can also be used to refine the results of other binning algorithms. The required input for this process is:
- The original assembly FASTA file
- MAGs from Rosella or another binning algorithm
- Coverage values for the original assembly OR a set of reads to calculate them with
Optionally, you can also provide the results of CheckMv1 or CheckMv2 (or AMBER) to limit refinement to only MAGs that are contaminated above the max contmiantion threshold.</p>
<pre><code class="language-bash">rosella refine -r scaffolds.fasta -d metabat_bins/ -x fna -C coverm.cov -o refined_bins/ -t 24
</code></pre>
<p>OR</p>
<pre><code class="language-bash">rosella refine -r scaffolds.fasta -d metabat_bins/ -x fna -1 short_s[12345].1.fastq.gz -2 short_s[12345].2.fastq.gz --longreads nanopore.fastq.gz -o refined_bins/ -t 24
</code></pre>
<p>The output of this process will be two folders, <code>refined_bins/</code> and <code>unchanged_bins/</code>. The former will contain the refined MAGs and the latter will contain the MAGs that were not refined (either because they were below the contamination threshold or no change occurred after refinement).</p>
<h2 id="outputs">Outputs</h2>
<p>The main output for rosella will be a set of MAGs denoted <code>rosella_bin_X.fna</code>. How many bins you get depends on your 
samples. Additionally, the kmer frequency table will be present: <code>kmer_frequencies.tsv</code>. And the coverage values if
they were calculated by rosella: <code>coverage.tsv</code>. Finally, you'll get a pretty UMAP projection plot coloured
by potential MAG clusters. This plot isn't necessary but it helps you interpret how well rosella partitioned out your contigs.
If you see only a couple of big noisy clusters then maybe something went wrong and you'll want to fiddle with a few of
the UMAP parameters. This is unlikely though, but if you feel like you do need to then please feel free to raise an issue
on this GitHub and I'll answer your question and add my respone to the FAQ to help other users.</p>

            </div>
            <div class='sidebar-right'>
                <div class='page-nav' id='page-nav'>
                    <p class='page-nav-header'>On this page</p>
                    <ul>
                        
                        <li class='page-nav-level-1'>
                            <a href='#getting-started'>Getting started</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#inputs'>Inputs</a>
                        </li>
                        
                        <li class='page-nav-level-3'>
                            <a href='#option-1:-precomputed-coverage-values'>Option 1: Precomputed coverage values</a>
                        </li>
                        
                        <li class='page-nav-level-3'>
                            <a href='#option-2:-use-rosella-to-get-coverage-values'>Option 2: Use rosella to get coverage values</a>
                        </li>
                        
                        <li class='page-nav-level-3'>
                            <a href='#option-3:-refining-the-results-of-other-binners'>Option 3: Refining the results of other binners</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#outputs'>Outputs</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <div class='wave-container'>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                    <path fill-opacity="0.35"
                        d="M0,192L60,213.3C120,235,240,277,360,277.3C480,277,600,235,720,192C840,149,960,107,1080,122.7C1200,139,1320,213,1380,250.7L1440,288L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.5"
                        d="M0,160L60,181.3C120,203,240,245,360,229.3C480,213,600,139,720,138.7C840,139,960,213,1080,229.3C1200,245,1320,203,1380,181.3L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.2"
                        d="M0,224L60,197.3C120,171,240,117,360,117.3C480,117,600,171,720,186.7C840,203,960,181,1080,186.7C1200,192,1320,224,1380,240L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                </svg>
                <p>Powered by <a href='https://cli.doctave.com' target='_blank'>Doctave</a></p>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/rosella/assets/katex.js?v=1721178457"></script>
    <script type="text/javascript" src="/rosella/assets/mermaid.js?v=1721178457"></script>
    <script type="text/javascript" src="/rosella/assets/elasticlunr.js?v=1721178457"></script>
    <script type="text/javascript" src="/rosella/assets/prism.js?v=1721178457"></script>
    <script type="text/javascript" src="/rosella/assets/doctave-app.js?v=1721178457"></script>

    
</body>

</html>